"use strict";function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(b,!0).forEach(function(c){_defineProperty(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(b).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _toConsumableArray(a){return _arrayWithoutHoles(a)||_iterableToArray(a)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a))return Array.from(a)}function _arrayWithoutHoles(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}}var intervals=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],standardTuningNotes=[intervals[4],intervals[9],intervals[2],intervals[7],intervals[11],intervals[4]],scalesMap={},degreesMap={major:{id:"major",degrees:[2,2,1,2,2,2,1]},minor:{id:"minor",degrees:[2,1,2,2,1,2,2]}},selectedKey=intervals[0],selectedScaleDegrees=degreesMap.major,selectedScale=null,stringsArray=[],shapeNotes=[],selectedShape=0,isPortrait=!1;function buildScale(a){var b=[],c=intervals.indexOf(a),d=!0,e=!1,f=void 0;try{for(var g,h,j=selectedScaleDegrees.degrees[Symbol.iterator]();!(d=(g=j.next()).done);d=!0){if(h=g.value,!intervals[c+h]){var k=c===intervals.length-1&&2===h?1:0;c=k,b=[].concat(_toConsumableArray(b),[intervals[k]]);continue}b=[].concat(_toConsumableArray(b),[intervals[c+h]]),c+=h}}catch(a){e=!0,f=a}finally{try{d||null==j["return"]||j["return"]()}finally{if(e)throw f}}return b}function buildScalesMap(){var a=!0,b=!1,c=void 0;try{for(var d,e,f=intervals[Symbol.iterator]();!(a=(d=f.next()).done);a=!0)e=d.value,scalesMap=_objectSpread({},scalesMap,_defineProperty({},e,{id:e,notes:buildScale(e)}))}catch(a){b=!0,c=a}finally{try{a||null==f["return"]||f["return"]()}finally{if(b)throw c}}selectedScale=scalesMap[selectedKey]}buildScalesMap();function getNotesOfString(a){for(var b=[],c=11===intervals.indexOf(a)?0:intervals.indexOf(a)+1;11>=b.length;)intervals[c]||(c=0),b=[].concat(_toConsumableArray(b),[intervals[c]]),c++;return b}function buildFretboard(a){var b=a.portrait;stringsArray=[];var c=!0===b?[].concat(standardTuningNotes):[].concat(standardTuningNotes).reverse();document.getElementById("fretBoard").innerHTML="<div class=\"frets-edge\">".concat(buildFrets(),"</div> \n    ").concat(c.map(function(a,b){return"".concat(buildString(a,b)," ").concat(5>b?"<div class=\"frets\">".concat(buildFrets(b),"</div>"):"")}).join("")," \n    <div class=\"frets-edge\">").concat(buildFrets(),"</div>\n    </div>");var d=[],e=[1,7,6,5,4,3,2],f=1;shapeNotes=[],stringsArray[0].map(function(a,b){var c=stringsArray[0].indexOf(stringsArray[0].find(function(a){return a.note===selectedKey}));return 0===b?(f=e[c],void(d=[{fret:a.fret,shapeNumber:f}])):void(f={fret:a.fret,shapeNumber:e[e.indexOf(f)-1]},f===void 0&&(f={fret:a.fret,shapeNumber:e[e.length-1]}),d=[].concat(_toConsumableArray(d),[f]))}),d.map(function(a,c){var d=b?_toConsumableArray(stringsArray):_toConsumableArray(stringsArray).reverse();d.map(function(b,d){var e=[],f=!0,g=b.indexOf(b.find(function(b){return b.fret===a.fret}));if(-1===g&&(f=!1,g=b.indexOf(b.find(function(b){return b.fret===a.fret+1}))),4===d||5===d){var h=f?g+1:g;e=b.slice(h,h+3)}else e=b.slice(g,g+3);return shapeNotes[c]?void(shapeNotes[c]=[].concat(_toConsumableArray(shapeNotes[c]),_toConsumableArray(e))):void(shapeNotes[c]=e)})}),shapeNotes[selectedShape].map(function(a){document.getElementById(a.id).className="highlight"})}var buildFrets=function(a){for(var b="",c=0;12>c;c++)b+="<div class=\"fret\">".concat(2===a&&(4===c||6===c||8===c)||11===c&&(0===a||4===a)?"<div class=\"fret-dot\"></div>":"","</div>");return b},buildString=function(a,b){var c=getNotesOfString(a).map(function(a,c){return{id:b+a,note:a,stringNumber:b,fret:c}});return stringsArray=[].concat(_toConsumableArray(stringsArray),[c.filter(function(a){return selectedScale.notes.includes(a.note)})]),"<div class=\"guitar-string\">".concat(c.map(function(a){return"<div class=\"note\">".concat(selectedScale.notes.includes(a.note)?"<div class=\"note-text-backdrop\"></div><span class=\"note-text\"><p  id=".concat(a.id,">").concat(a.note,"</p></span>"):"","</div>")}).join(""),"</div>")};function buildKeySelector(){var a=[];for(var c in scalesMap)a=[].concat(_toConsumableArray(a),["<option value=\"".concat(c,"\">").concat(c,"</option>")]);var b=document.getElementById("keySelect");b.innerHTML=a.join(),b.value=selectedKey}function buildScaleSelector(){var a=[];for(var c in degreesMap)a=[].concat(_toConsumableArray(a),["<option value=\"".concat(c,"\">").concat(c,"</option>")]);var b=document.getElementById("scaleSelect");b.innerHTML=a.join(),b.value=selectedScaleDegrees.id}function reDrawApp(){return buildScalesMap(),buildKeySelector(),buildScaleSelector(),window.innerHeight>window.innerWidth?(document.getElementById("wrapper").className="app-wrapper portrait-mode",isPortrait=!0,void buildFretboard({portrait:!0})):void(isPortrait=!1,document.getElementById("wrapper").className="app-wrapper landscape-mode",buildFretboard({portrait:!1}))}window.addEventListener("resize",function(){reDrawApp()}),document.getElementById("keySelect").addEventListener("change",function(a){selectedKey=a.target.value,document.getElementById("keySelect").value=a.target.value,reDrawApp()}),document.getElementById("scaleSelect").addEventListener("change",function(a){selectedScaleDegrees=degreesMap[a.target.value],document.getElementById("scaleSelect").value=a.target.value,reDrawApp()}),reDrawApp(),document.getElementById("fullScreen").addEventListener("click",function(){screenfull.isEnabled&&screenfull.toggle()}),document.querySelectorAll(".shapeSelect").forEach(function(a){return a.addEventListener("click",function(a){selectedShape=a.target.getAttribute("shapeIndex"),buildFretboard(isPortrait)})});

//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RkQsQyxDQUlBLFFBQVEsQ0FBQyxjQUFULENBQXdCLFdBQXhCLEVBQXFDLGdCQUFyQyxDQUFzRCxRQUF0RCxDQUFnRSxTQUFBLENBQUMsQ0FBSSxDQUNuRSxXQUFXLENBQUcsQ0FBQyxDQUFDLE1BQUYsQ0FBUyxLQUQ0QyxDQUVuRSxRQUFRLENBQUMsY0FBVCxDQUF3QixXQUF4QixFQUFxQyxLQUFyQyxDQUE2QyxDQUFDLENBQUMsTUFBRixDQUFTLEtBRmEsQ0FJbkUsU0FBUyxFQUNWLENBTEQsQyxDQU9BLFFBQVEsQ0FBQyxjQUFULENBQXdCLGFBQXhCLEVBQXVDLGdCQUF2QyxDQUF3RCxRQUF4RCxDQUFrRSxTQUFBLENBQUMsQ0FBSSxDQUNyRSxvQkFBb0IsQ0FBRyxVQUFVLENBQUMsQ0FBQyxDQUFDLE1BQUYsQ0FBUyxLQUFWLENBRG9DLENBRXJFLFFBQVEsQ0FBQyxjQUFULENBQXdCLGFBQXhCLEVBQXVDLEtBQXZDLENBQStDLENBQUMsQ0FBQyxNQUFGLENBQVMsS0FGYSxDQUlyRSxTQUFTLEVBQ1YsQ0FMRCxDLENBT0EsU0FBUyxFLENBRVQsUUFBUSxDQUFDLGNBQVQsQ0FBd0IsWUFBeEIsRUFBc0MsZ0JBQXRDLENBQXVELE9BQXZELENBQWdFLFVBQUssQ0FDOUQsVUFBVSxDQUFDLFNBRG1ELEVBSW5FLFVBQVUsQ0FBQyxNQUFYLEVBQ0QsQ0FMRCxDLENBT0EsUUFBUSxDQUFDLGdCQUFULENBQTBCLGNBQTFCLEVBQTBDLE9BQTFDLENBQWtELFNBQUEsQ0FBRSxRQUFFLENBQUEsQ0FBRSxDQUFDLGdCQUFILENBQW9CLE9BQXBCLENBQTZCLFNBQUEsQ0FBQyxDQUFFLENBQ3BGLGFBQWEsQ0FBRyxDQUFDLENBQUMsTUFBRixDQUFTLFlBQVQsQ0FBc0IsWUFBdEIsQ0FEb0UsQ0FFcEYsY0FBYyxDQUFDLFVBQUQsQ0FDZixDQUhxRCxDQUFGLENBQXBELEMiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBpbnRlcnZhbHMgPSBbXG4gICdDJyxcbiAgJ0MjJyxcbiAgJ0QnLFxuICAnRCMnLFxuICAnRScsXG4gICdGJyxcbiAgJ0YjJyxcbiAgJ0cnLFxuICAnRyMnLFxuICAnQScsXG4gICdBIycsXG4gICdCJ1xuXTtcblxuY29uc3Qgc3RhbmRhcmRUdW5pbmdOb3RlcyA9IFtcbiAgaW50ZXJ2YWxzWzRdLFxuICBpbnRlcnZhbHNbOV0sXG4gIGludGVydmFsc1syXSxcbiAgaW50ZXJ2YWxzWzddLFxuICBpbnRlcnZhbHNbMTFdLFxuICBpbnRlcnZhbHNbNF1cbl07XG5cbmxldCBzY2FsZXNNYXAgPSB7fTtcblxuY29uc3QgZGVncmVlc01hcCA9IHtcbiAgbWFqb3I6IHsgaWQ6ICdtYWpvcicsIGRlZ3JlZXM6IFsyLCAyLCAxLCAyLCAyLCAyLCAxXSB9LFxuICBtaW5vcjogeyBpZDogJ21pbm9yJywgZGVncmVlczogWzIsIDEsIDIsIDIsIDEsIDIsIDJdIH1cbn07XG5cbmxldCBzZWxlY3RlZEtleSA9IGludGVydmFsc1swXTtcbmxldCBzZWxlY3RlZFNjYWxlRGVncmVlcyA9IGRlZ3JlZXNNYXAubWFqb3I7XG5sZXQgc2VsZWN0ZWRTY2FsZSA9IG51bGw7XG5cbmxldCBzdHJpbmdzQXJyYXkgPSBbXTtcbmxldCBzaGFwZU5vdGVzID0gW11cbmxldCBzZWxlY3RlZFNoYXBlID0gMFxuXG5sZXQgaXNQb3J0cmFpdCA9IGZhbHNlXG5cbmZ1bmN0aW9uIGJ1aWxkU2NhbGUocm9vdE5vdGUpIHtcbiAgbGV0IHNjYWxlID0gW107XG5cbiAgbGV0IGkgPSBpbnRlcnZhbHMuaW5kZXhPZihyb290Tm90ZSk7XG4gIGZvciAoY29uc3QgZGVncmVlIG9mIHNlbGVjdGVkU2NhbGVEZWdyZWVzLmRlZ3JlZXMpIHtcbiAgICBpZiAoIWludGVydmFsc1tpICsgZGVncmVlXSkge1xuICAgICAgbGV0IHN0YXJ0SW5kZXggPSBpID09PSBpbnRlcnZhbHMubGVuZ3RoIC0gMSAmJiBkZWdyZWUgPT09IDIgPyAxIDogMDtcbiAgICAgIGkgPSBzdGFydEluZGV4O1xuICAgICAgc2NhbGUgPSBbLi4uc2NhbGUsIGludGVydmFsc1tzdGFydEluZGV4XV07XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBzY2FsZSA9IFsuLi5zY2FsZSwgaW50ZXJ2YWxzW2kgKyBkZWdyZWVdXTtcblxuICAgIGkgKz0gZGVncmVlO1xuICB9XG4gIHJldHVybiBzY2FsZTtcbn1cblxuZnVuY3Rpb24gYnVpbGRTY2FsZXNNYXAoKSB7XG4gIGZvciAobGV0IGludGVydmFsIG9mIGludGVydmFscykge1xuICAgIHNjYWxlc01hcCA9IHtcbiAgICAgIC4uLnNjYWxlc01hcCxcbiAgICAgIFtpbnRlcnZhbF06IHsgaWQ6IGludGVydmFsLCBub3RlczogYnVpbGRTY2FsZShpbnRlcnZhbCkgfVxuICAgIH07XG4gIH1cbiAgc2VsZWN0ZWRTY2FsZSA9IHNjYWxlc01hcFtzZWxlY3RlZEtleV07XG59XG5cbmJ1aWxkU2NhbGVzTWFwKCk7XG5cbmZ1bmN0aW9uIGdldE5vdGVzT2ZTdHJpbmcoc3RhcnRpbmdOb3RlKSB7XG4gIGxldCBub3RlcyA9IFtdO1xuICBsZXQgaSA9XG4gICAgaW50ZXJ2YWxzLmluZGV4T2Yoc3RhcnRpbmdOb3RlKSA9PT0gMTFcbiAgICAgID8gMFxuICAgICAgOiBpbnRlcnZhbHMuaW5kZXhPZihzdGFydGluZ05vdGUpICsgMTtcblxuICB3aGlsZSAobm90ZXMubGVuZ3RoIDw9IDExKSB7XG4gICAgaWYgKCFpbnRlcnZhbHNbaV0pIHtcbiAgICAgIGkgPSAwO1xuICAgIH1cbiAgICBub3RlcyA9IFsuLi5ub3RlcywgaW50ZXJ2YWxzW2ldXTtcbiAgICBpKys7XG4gIH1cblxuICByZXR1cm4gbm90ZXM7XG59XG5cbmZ1bmN0aW9uIGJ1aWxkRnJldGJvYXJkKHsgcG9ydHJhaXQgfSkge1xuICBzdHJpbmdzQXJyYXkgPSBbXTtcbiAgY29uc3Qgc3RhcnRpbmdOb3RlcyA9XG4gICAgcG9ydHJhaXQgPT09IHRydWVcbiAgICAgID8gWy4uLnN0YW5kYXJkVHVuaW5nTm90ZXNdXG4gICAgICA6IFsuLi5zdGFuZGFyZFR1bmluZ05vdGVzXS5yZXZlcnNlKCk7XG5cbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXG4gICAgJ2ZyZXRCb2FyZCdcbiAgKS5pbm5lckhUTUwgPSBgPGRpdiBjbGFzcz1cImZyZXRzLWVkZ2VcIj4ke2J1aWxkRnJldHMoKX08L2Rpdj4gXG4gICAgJHtzdGFydGluZ05vdGVzXG4gICAgICAubWFwKFxuICAgICAgICAoc3RhcnRpbmdOb3RlLCBzdHJpbmdOdW1iZXIpID0+XG4gICAgICAgICAgYCR7YnVpbGRTdHJpbmcoc3RhcnRpbmdOb3RlLCBzdHJpbmdOdW1iZXIpfSAke1xuICAgICAgICAgICAgc3RyaW5nTnVtYmVyIDwgNVxuICAgICAgICAgICAgICA/IGA8ZGl2IGNsYXNzPVwiZnJldHNcIj4ke2J1aWxkRnJldHMoc3RyaW5nTnVtYmVyKX08L2Rpdj5gXG4gICAgICAgICAgICAgIDogJydcbiAgICAgICAgICB9YFxuICAgICAgKVxuICAgICAgLmpvaW4oJycpfSBcbiAgICA8ZGl2IGNsYXNzPVwiZnJldHMtZWRnZVwiPiR7YnVpbGRGcmV0cygpfTwvZGl2PlxuICAgIDwvZGl2PmA7XG5cbiAgbGV0IHNoYXBlcyA9IFtdO1xuICBjb25zdCBzaGFwZU51bWJlcnMgPSBbMSwgNywgNiwgNSwgNCwgMywgMl07XG4gIGxldCBjdXJyZW50U2hhcGUgPSAxO1xuXG4gIHNoYXBlTm90ZXMgPSBbXVxuXG4gIHN0cmluZ3NBcnJheVswXS5tYXAoKG5vdGUsIG5vdGVJbmRleCkgPT4ge1xuICAgIGNvbnN0IHJvb3ROb3RlSW5kZXggPSBzdHJpbmdzQXJyYXlbMF0uaW5kZXhPZihcbiAgICAgIHN0cmluZ3NBcnJheVswXS5maW5kKG5vdGUgPT4gbm90ZS5ub3RlID09PSBzZWxlY3RlZEtleSlcbiAgICApO1xuXG4gICAgaWYgKG5vdGVJbmRleCA9PT0gMCkge1xuICAgICAgY3VycmVudFNoYXBlID0gc2hhcGVOdW1iZXJzW3Jvb3ROb3RlSW5kZXhdO1xuICAgICAgc2hhcGVzID0gW3sgZnJldDogbm90ZS5mcmV0LCBzaGFwZU51bWJlcjogY3VycmVudFNoYXBlIH1dO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGN1cnJlbnRTaGFwZSA9IHsgZnJldDogbm90ZS5mcmV0LCBzaGFwZU51bWJlcjogc2hhcGVOdW1iZXJzW3NoYXBlTnVtYmVycy5pbmRleE9mKGN1cnJlbnRTaGFwZSkgLSAxXSB9O1xuXG4gICAgaWYgKGN1cnJlbnRTaGFwZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBjdXJyZW50U2hhcGUgPSB7IGZyZXQ6IG5vdGUuZnJldCwgc2hhcGVOdW1iZXI6IHNoYXBlTnVtYmVyc1tzaGFwZU51bWJlcnMubGVuZ3RoIC0gMV0gfVxuICAgIH1cblxuICAgIHNoYXBlcyA9IFsuLi5zaGFwZXMsIGN1cnJlbnRTaGFwZV07XG4gIH0pO1xuXG4gIHNoYXBlcy5tYXAoKHNoYXBlLCBzaGFwZUluZGV4KSA9PiB7XG4gICAgbGV0IHN0cmluZ3MgPSBwb3J0cmFpdD8gWy4uLnN0cmluZ3NBcnJheV0gOiBbLi4uc3RyaW5nc0FycmF5XS5yZXZlcnNlKClcbiAgICBzdHJpbmdzLm1hcCgoc3RyaW5nLCBzdHJpbmdOdW1iZXIpID0+IHtcbiAgICAgIGxldCBub3RlcyA9IFtdO1xuICAgICAgbGV0IG9uUm9vdEZyZXQgPSB0cnVlXG4gICAgICBsZXQgbm90ZU9uU2hhcGVTdGFydEZyZXQgPSBzdHJpbmcuaW5kZXhPZihzdHJpbmcuZmluZChub3RlPT5ub3RlLmZyZXQgPT09IHNoYXBlLmZyZXQpKVxuICAgICAgaWYobm90ZU9uU2hhcGVTdGFydEZyZXQgPT09IC0xKXtcbiAgICAgICAgb25Sb290RnJldCA9IGZhbHNlXG4gICAgICAgIG5vdGVPblNoYXBlU3RhcnRGcmV0ID0gc3RyaW5nLmluZGV4T2Yoc3RyaW5nLmZpbmQobm90ZT0+bm90ZS5mcmV0ID09PSBzaGFwZS5mcmV0ICsgMSkpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmIChzdHJpbmdOdW1iZXIgPT09IDQgfHwgc3RyaW5nTnVtYmVyID09PSA1KSB7XG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gb25Sb290RnJldD8gbm90ZU9uU2hhcGVTdGFydEZyZXQgKyAxIDogbm90ZU9uU2hhcGVTdGFydEZyZXRcbiAgICAgICAgbm90ZXMgPSBzdHJpbmcuc2xpY2Uoc3RhcnQsIHN0YXJ0ICsgMyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBub3RlcyA9IHN0cmluZy5zbGljZShub3RlT25TaGFwZVN0YXJ0RnJldCwgbm90ZU9uU2hhcGVTdGFydEZyZXQgKyAzKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFzaGFwZU5vdGVzW3NoYXBlSW5kZXhdKSB7XG4gICAgICAgIHNoYXBlTm90ZXNbc2hhcGVJbmRleF0gPSBub3RlcztcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgc2hhcGVOb3Rlc1tzaGFwZUluZGV4XSA9IFtcbiAgICAgICAgLi4uc2hhcGVOb3Rlc1tzaGFwZUluZGV4XSxcbiAgICAgICAgLi4ubm90ZXNcbiAgICAgIF07XG4gICAgfSk7XG4gIH0pO1xuXG4gIHNoYXBlTm90ZXNbc2VsZWN0ZWRTaGFwZV0ubWFwKG5vdGUgPT4ge1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG5vdGUuaWQpLmNsYXNzTmFtZSA9ICdoaWdobGlnaHQnO1xuICB9KTtcbn1cblxuY29uc3QgYnVpbGRGcmV0cyA9IHN0cmluZ051bWJlciA9PiB7XG4gIGxldCBmcmV0cyA9IGBgO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IDEyOyBpKyspIHtcbiAgICBmcmV0cyArPSBgPGRpdiBjbGFzcz1cImZyZXRcIj4ke1xuICAgICAgKHN0cmluZ051bWJlciA9PT0gMiAmJiAoaSA9PT0gNCB8fCBpID09PSA2IHx8IGkgPT09IDgpKSB8fFxuICAgICAgKGkgPT09IDExICYmIChzdHJpbmdOdW1iZXIgPT09IDAgfHwgc3RyaW5nTnVtYmVyID09PSA0KSlcbiAgICAgICAgPyBgPGRpdiBjbGFzcz1cImZyZXQtZG90XCI+PC9kaXY+YFxuICAgICAgICA6ICcnXG4gICAgfTwvZGl2PmA7XG4gIH1cbiAgcmV0dXJuIGZyZXRzO1xufTtcblxuY29uc3QgYnVpbGRTdHJpbmcgPSAoc3RhcnRpbmdOb3RlLCBzdHJpbmdOdW1iZXIpID0+IHtcbiAgY29uc3Qgc3RyaW5nTm90ZXMgPSBnZXROb3Rlc09mU3RyaW5nKHN0YXJ0aW5nTm90ZSkubWFwKChub3RlLCBmcmV0KSA9PiAoe1xuICAgIGlkOiBzdHJpbmdOdW1iZXIgKyBub3RlLFxuICAgIG5vdGUsXG4gICAgc3RyaW5nTnVtYmVyLFxuICAgIGZyZXRcbiAgfSkpO1xuICBzdHJpbmdzQXJyYXkgPSBbXG4gICAgLi4uc3RyaW5nc0FycmF5LFxuICAgIHN0cmluZ05vdGVzLmZpbHRlcihub3RlID0+IHNlbGVjdGVkU2NhbGUubm90ZXMuaW5jbHVkZXMobm90ZS5ub3RlKSlcbiAgXTtcblxuICByZXR1cm4gYDxkaXYgY2xhc3M9XCJndWl0YXItc3RyaW5nXCI+JHtzdHJpbmdOb3Rlc1xuICAgIC5tYXAoXG4gICAgICBub3RlID0+XG4gICAgICAgIGA8ZGl2IGNsYXNzPVwibm90ZVwiPiR7XG4gICAgICAgICAgc2VsZWN0ZWRTY2FsZS5ub3Rlcy5pbmNsdWRlcyhub3RlLm5vdGUpXG4gICAgICAgICAgICA/IGA8ZGl2IGNsYXNzPVwibm90ZS10ZXh0LWJhY2tkcm9wXCI+PC9kaXY+PHNwYW4gY2xhc3M9XCJub3RlLXRleHRcIj48cCAgaWQ9JHtub3RlLmlkfT4ke25vdGUubm90ZX08L3A+PC9zcGFuPmBcbiAgICAgICAgICAgIDogJydcbiAgICAgICAgfTwvZGl2PmBcbiAgICApXG4gICAgLmpvaW4oJycpfTwvZGl2PmA7XG59O1xuXG5mdW5jdGlvbiBidWlsZEtleVNlbGVjdG9yKCkge1xuICBsZXQgb3B0aW9ucyA9IFtdO1xuICBmb3IgKGNvbnN0IGtleU5hbWUgaW4gc2NhbGVzTWFwKSB7XG4gICAgb3B0aW9ucyA9IFsuLi5vcHRpb25zLCBgPG9wdGlvbiB2YWx1ZT1cIiR7a2V5TmFtZX1cIj4ke2tleU5hbWV9PC9vcHRpb24+YF07XG4gIH1cbiAgbGV0IGtleVNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdrZXlTZWxlY3QnKTtcbiAga2V5U2VsZWN0LmlubmVySFRNTCA9IG9wdGlvbnMuam9pbigpO1xuICBrZXlTZWxlY3QudmFsdWUgPSBzZWxlY3RlZEtleTtcbn1cblxuZnVuY3Rpb24gYnVpbGRTY2FsZVNlbGVjdG9yKCkge1xuICBsZXQgb3B0aW9ucyA9IFtdO1xuICBmb3IgKGNvbnN0IHNjYWxlTmFtZSBpbiBkZWdyZWVzTWFwKSB7XG4gICAgb3B0aW9ucyA9IFtcbiAgICAgIC4uLm9wdGlvbnMsXG4gICAgICBgPG9wdGlvbiB2YWx1ZT1cIiR7c2NhbGVOYW1lfVwiPiR7c2NhbGVOYW1lfTwvb3B0aW9uPmBcbiAgICBdO1xuICB9XG4gIGxldCBzY2FsZVNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY2FsZVNlbGVjdCcpO1xuICBzY2FsZVNlbGVjdC5pbm5lckhUTUwgPSBvcHRpb25zLmpvaW4oKTtcbiAgc2NhbGVTZWxlY3QudmFsdWUgPSBzZWxlY3RlZFNjYWxlRGVncmVlcy5pZDtcbn1cblxuZnVuY3Rpb24gcmVEcmF3QXBwKCkge1xuICBidWlsZFNjYWxlc01hcCgpO1xuICBidWlsZEtleVNlbGVjdG9yKCk7XG4gIGJ1aWxkU2NhbGVTZWxlY3RvcigpO1xuXG4gIGlmICh3aW5kb3cuaW5uZXJIZWlnaHQgPiB3aW5kb3cuaW5uZXJXaWR0aCkge1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3cmFwcGVyJykuY2xhc3NOYW1lID0gJ2FwcC13cmFwcGVyIHBvcnRyYWl0LW1vZGUnO1xuICAgIGlzUG9ydHJhaXQgPSB0cnVlXG4gICAgYnVpbGRGcmV0Ym9hcmQoeyBwb3J0cmFpdDogdHJ1ZSB9KTtcbiAgICByZXR1cm47XG4gIH1cbiAgaXNQb3J0cmFpdCA9IGZhbHNlXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3cmFwcGVyJykuY2xhc3NOYW1lID0gJ2FwcC13cmFwcGVyIGxhbmRzY2FwZS1tb2RlJztcbiAgYnVpbGRGcmV0Ym9hcmQoeyBwb3J0cmFpdDogZmFsc2UgfSk7XG59XG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCAoKSA9PiB7XG4gIHJlRHJhd0FwcCgpO1xufSk7XG5cbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdrZXlTZWxlY3QnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBlID0+IHtcbiAgc2VsZWN0ZWRLZXkgPSBlLnRhcmdldC52YWx1ZTtcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2tleVNlbGVjdCcpLnZhbHVlID0gZS50YXJnZXQudmFsdWU7XG5cbiAgcmVEcmF3QXBwKCk7XG59KTtcblxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjYWxlU2VsZWN0JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZSA9PiB7XG4gIHNlbGVjdGVkU2NhbGVEZWdyZWVzID0gZGVncmVlc01hcFtlLnRhcmdldC52YWx1ZV07XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY2FsZVNlbGVjdCcpLnZhbHVlID0gZS50YXJnZXQudmFsdWU7XG5cbiAgcmVEcmF3QXBwKCk7XG59KTtcblxucmVEcmF3QXBwKCk7XG5cbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmdWxsU2NyZWVuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcbiAgaWYgKCFzY3JlZW5mdWxsLmlzRW5hYmxlZCkge1xuICAgIHJldHVybjtcbiAgfVxuICBzY3JlZW5mdWxsLnRvZ2dsZSgpO1xufSk7XG5cbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zaGFwZVNlbGVjdCcpLmZvckVhY2goZWw9PmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZT0+e1xuICBzZWxlY3RlZFNoYXBlID0gZS50YXJnZXQuZ2V0QXR0cmlidXRlKCdzaGFwZUluZGV4JykgXG4gIGJ1aWxkRnJldGJvYXJkKGlzUG9ydHJhaXQpXG59KSlcbiJdfQ==